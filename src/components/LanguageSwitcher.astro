---
// Language Switcher Component
---

<div class="language-switcher flex items-center gap-2">
  <button
    class="lang-btn px-3 py-1 rounded text-sm font-medium transition-all duration-300"
    data-lang="en"
  >
    EN
  </button>
  <span class="text-white/30">|</span>
  <button
    class="lang-btn px-3 py-1 rounded text-sm font-medium transition-all duration-300"
    data-lang="nl"
  >
    NL
  </button>
  <span class="text-white/30">|</span>
  <button
    class="lang-btn px-3 py-1 rounded text-sm font-medium transition-all duration-300"
    data-lang="ko"
  >
    KO
  </button>
</div>

<script>
  import { getPreferredLanguage, setLanguage } from '../i18n/utils';
  
  function updateButtons() {
    const currentLang = getPreferredLanguage();
    const buttons = document.querySelectorAll('.lang-btn');
    
    buttons.forEach((btn) => {
      const lang = (btn as HTMLElement).dataset.lang;
      if (lang === currentLang) {
        btn.classList.add('bg-amber-500', 'text-white');
        btn.classList.remove('text-white/60', 'hover:text-white');
      } else {
        btn.classList.remove('bg-amber-500', 'text-white');
        btn.classList.add('text-white/60', 'hover:text-white');
      }
    });
  }
  
  function setupLanguageSwitcher() {
    // Use class-based selection to handle multiple instances (desktop + mobile)
    const langButtons = document.querySelectorAll('.lang-btn');
    
    // Set initial state
    updateButtons();
    
    // Add click handlers to all language buttons
    langButtons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const lang = (btn as HTMLElement).dataset.lang;
        if (lang) {
          setLanguage(lang as 'en' | 'nl' | 'ko');
          updateButtons();
          window.location.reload(); // Reload to apply translations
        }
      });
    });
  }
  
  // Initialize on page load
  setupLanguageSwitcher();
  
  // Reinitialize after navigation (for Astro's view transitions if enabled)
  document.addEventListener('astro:page-load', setupLanguageSwitcher);
</script>

<style>
  .lang-btn {
    cursor: pointer;
    user-select: none;
  }
  
  .lang-btn:active {
    transform: scale(0.95);
  }
</style>
